<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROI Calculator | EasyVista AI Sales Enablement</title>
    <link rel="icon" href="../favicon.svg" type="image/svg+xml">
    <meta name="theme-color" content="#D97757">
    <link rel="stylesheet" href="css/design-system.css">
    <style>
        /* =====================================
           ROI Calculator - Compact Side-by-Side Layout
           ===================================== */

        .roi-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-6);
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-6);
            align-items: start;
        }

        /* ===== Controls Panel (Left) ===== */
        .controls-panel {
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
        }

        .controls-panel__header {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-3);
            border-bottom: 1px solid var(--color-border);
        }

        /* ===== Results Panel (Right - Sticky) ===== */
        .results-panel {
            position: sticky;
            top: 80px;
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }

        .results-panel__header {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-3);
            border-bottom: 1px solid var(--color-border);
        }

        /* ===== Compact Slider Styles ===== */
        .slider-group {
            margin-bottom: var(--space-4);
        }

        .slider-group__header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: var(--space-2);
        }

        .slider-group__label {
            font-weight: 500;
            font-size: var(--font-size-sm);
            color: var(--color-text-primary);
        }

        .slider-group__value {
            font-size: var(--font-size-base);
            font-weight: 700;
            color: var(--color-ev-teal);
        }

        .product-badge {
            display: inline-block;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            padding: 2px 8px;
            border-radius: var(--radius-full);
            margin-left: var(--space-2);
        }
        .product-badge--lemlist {
            background: rgba(77, 192, 199, 0.15);
            color: var(--color-ev-teal);
        }
        .product-badge--loopio {
            background: rgba(201, 100, 66, 0.15);
            color: var(--color-accent-primary);
        }

        .slider-input {
            width: 100%;
            height: 6px;
            border-radius: var(--radius-full);
            background: var(--color-bg-secondary);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--color-ev-teal);
            cursor: pointer;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-fast);
        }

        .slider-input::-webkit-slider-thumb:hover {
            background: var(--color-ev-teal-hover);
            transform: scale(1.1);
        }

        .slider-input::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--color-ev-teal);
            cursor: pointer;
            border: none;
        }

        .slider-group__range {
            display: flex;
            justify-content: space-between;
            font-size: var(--font-size-xs);
            color: var(--color-text-muted);
            margin-top: var(--space-1);
        }

        /* ===== Two-Column Input Grid ===== */
        .inputs-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4);
        }

        /* ===== Metric Cards Grid ===== */
        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-3);
            margin-bottom: var(--space-4);
        }

        .metric-card {
            background-color: var(--color-bg-secondary);
            border-radius: var(--radius-md);
            padding: var(--space-4);
            text-align: center;
        }

        .metric-card__label {
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.03em;
            font-weight: 600;
            margin-bottom: var(--space-2);
        }

        .metric-card__value {
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--color-ev-teal);
            line-height: 1.2;
        }

        /* ===== Highlighted Metrics (ROI & Payback) ===== */
        .metric-card--highlight {
            background-color: var(--color-ev-teal-soft);
            border: 1px solid var(--color-ev-teal);
        }

        .metric-card--highlight .metric-card__value {
            font-size: var(--font-size-2xl);
            color: var(--color-ev-teal);
        }

        /* ===== Hero ROI Display ===== */
        .roi-hero {
            background-color: var(--color-ev-teal-soft);
            border: 2px solid var(--color-ev-teal);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            text-align: center;
            margin-bottom: var(--space-4);
        }

        .roi-hero__label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .roi-hero__value {
            font-size: var(--font-size-4xl);
            font-weight: 700;
            color: var(--color-ev-teal);
            line-height: 1.1;
            margin: var(--space-2) 0;
        }

        .roi-hero__subtext {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        /* ===== Payback Badge ===== */
        .payback-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            background-color: var(--color-success-bg);
            color: var(--color-success);
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-full);
            font-weight: 600;
            font-size: var(--font-size-sm);
            margin-top: var(--space-3);
        }

        /* ===== Collapsible Sections ===== */
        .collapsible {
            margin-top: var(--space-6);
        }

        .collapsible__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-4);
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            color: var(--color-text-primary);
            transition: all var(--transition-fast);
        }

        .collapsible__header:hover {
            background-color: var(--color-bg-secondary);
        }

        .collapsible__icon {
            transition: transform var(--transition-fast);
        }

        .collapsible__content {
            display: none;
            padding: var(--space-4);
            background-color: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-top: none;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
        }

        .collapsible.open .collapsible__content {
            display: block;
        }

        .collapsible.open .collapsible__icon {
            transform: rotate(180deg);
        }

        /* ===== Formula Display ===== */
        .formula {
            background-color: var(--color-bg-card);
            padding: var(--space-3);
            border-radius: var(--radius-sm);
            font-family: monospace;
            font-size: var(--font-size-sm);
            color: var(--color-text-primary);
            margin: var(--space-2) 0;
        }

        /* ===== Assumption Pills ===== */
        .assumptions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-3);
        }

        .assumption-pill {
            background-color: var(--color-bg-card);
            padding: var(--space-3);
            border-radius: var(--radius-md);
            border: 1px solid var(--color-border);
        }

        .assumption-pill__label {
            font-size: var(--font-size-xs);
            color: var(--color-text-muted);
            font-weight: 600;
        }

        .assumption-pill__value {
            font-size: var(--font-size-sm);
            color: var(--color-text-primary);
            margin-top: var(--space-1);
        }

        /* ===== Comparison Row ===== */
        .comparison-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-3);
            background-color: var(--color-bg-secondary);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-2);
        }

        .comparison-row__label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .comparison-row__values {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .comparison-row__before {
            color: var(--color-text-muted);
            font-size: var(--font-size-sm);
        }

        .comparison-row__arrow {
            color: var(--color-ev-teal);
        }

        .comparison-row__after {
            color: var(--color-ev-teal);
            font-weight: 600;
        }

        /* ===== Responsive Design ===== */
        @media (max-width: 900px) {
            .roi-layout {
                grid-template-columns: 1fr;
            }

            .results-panel {
                position: static;
                max-height: none;
            }

            .inputs-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 600px) {
            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .roi-hero__value {
                font-size: var(--font-size-3xl);
            }
        }

        /* ===== Info Tip ===== */
        .info-tip {
            font-size: var(--font-size-xs);
            color: var(--color-text-muted);
            padding: var(--space-3);
            background-color: var(--color-info-bg);
            border-radius: var(--radius-md);
            margin-top: var(--space-4);
        }

        /* ===== CTA Section (Compact) ===== */
        .cta-compact {
            text-align: center;
            padding: var(--space-8);
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            margin-top: var(--space-6);
        }

        .cta-compact h3 {
            margin-bottom: var(--space-3);
        }

        .cta-compact p {
            color: var(--color-text-secondary);
            margin-bottom: var(--space-4);
        }

        .cta-compact .btn-group {
            display: flex;
            gap: var(--space-3);
            justify-content: center;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
        <span id="theme-icon">üåô</span>
    </button>

    <nav class="nav">
        <div class="nav__inner">
            <a href="index.html" class="nav__brand">EasyVista AI Enablement</a>
            <button class="nav__toggle" onclick="toggleNav()" aria-label="Toggle navigation">‚ò∞</button>
            <div class="nav__links" id="nav-links">
                <a href="index.html" class="nav__link">Home</a>
                <a href="progress.html" class="nav__link">Progress</a>
                <a href="guides/index.html" class="nav__link">Guides</a>
                <a href="roi.html" class="nav__link nav__link--active">ROI</a>
            </div>
        </div>
    </nav>

    <div class="breadcrumb">
        <a href="index.html">Home</a> / <span>ROI Calculator</span>
    </div>

    <main>
        <!-- Compact Hero -->
        <section style="padding: var(--space-8) var(--space-6); text-align: center; background-color: var(--color-bg-secondary);">
            <h1 style="font-size: var(--font-size-2xl); font-weight: 700; margin-bottom: var(--space-2);">ROI Calculator</h1>
            <p style="color: var(--color-text-secondary); max-width: 500px; margin: 0 auto;">Adjust inputs to see real-time financial projections</p>
        </section>

        <!-- Main Calculator Layout: Side-by-Side -->
        <div class="roi-layout">
            <!-- LEFT: Controls Panel -->
            <div class="controls-panel">
                <div class="controls-panel__header">Customize Your Scenario</div>

                <div class="inputs-grid">
                    <!-- Current Opportunities -->
                    <div class="slider-group">
                        <div class="slider-group__header">
                            <span class="slider-group__label">Current Opps/Quarter <span class="product-badge product-badge--lemlist">Lemlist</span></span>
                            <span class="slider-group__value" id="val-current-opps">18</span>
                        </div>
                        <input type="range" class="slider-input" id="slider-current-opps" min="10" max="25" value="18">
                        <div class="slider-group__range"><span>10</span><span>25</span></div>
                    </div>

                    <!-- Target Opportunities -->
                    <div class="slider-group">
                        <div class="slider-group__header">
                            <span class="slider-group__label">Target Opps/Quarter <span class="product-badge product-badge--lemlist">Lemlist</span></span>
                            <span class="slider-group__value" id="val-target-opps">28</span>
                        </div>
                        <input type="range" class="slider-input" id="slider-target-opps" min="20" max="40" value="28">
                        <div class="slider-group__range"><span>20</span><span>40</span></div>
                    </div>

                    <!-- Deal Size -->
                    <div class="slider-group">
                        <div class="slider-group__header">
                            <span class="slider-group__label">Avg Deal Size <span class="product-badge product-badge--lemlist">Lemlist</span></span>
                            <span class="slider-group__value">$<span id="val-deal-size">50K</span></span>
                        </div>
                        <input type="range" class="slider-input" id="slider-deal-size" min="25000" max="150000" value="50000" step="5000">
                        <div class="slider-group__range"><span>$25K</span><span>$150K</span></div>
                    </div>

                    <!-- Win Rate -->
                    <div class="slider-group">
                        <div class="slider-group__header">
                            <span class="slider-group__label">Win Rate <span class="product-badge product-badge--lemlist">Lemlist</span></span>
                            <span class="slider-group__value"><span id="val-win-rate">12</span>%</span>
                        </div>
                        <input type="range" class="slider-input" id="slider-win-rate" min="5" max="25" value="12">
                        <div class="slider-group__range"><span>5%</span><span>25%</span></div>
                    </div>

                    <!-- RFP Hours Saved -->
                    <div class="slider-group">
                        <div class="slider-group__header">
                            <span class="slider-group__label">RFP Hours Saved <span class="product-badge product-badge--loopio">Loopio</span></span>
                            <span class="slider-group__value"><span id="val-rfp-hours">16</span> hrs</span>
                        </div>
                        <input type="range" class="slider-input" id="slider-rfp-hours" min="8" max="40" value="16" step="2">
                        <div class="slider-group__range"><span>8 hrs</span><span>40 hrs</span></div>
                    </div>

                    <!-- Team Size -->
                    <div class="slider-group">
                        <div class="slider-group__header">
                            <span class="slider-group__label">Team Size <span class="product-badge product-badge--lemlist">Lemlist</span></span>
                            <span class="slider-group__value"><span id="val-team-size">13</span></span>
                        </div>
                        <input type="range" class="slider-input" id="slider-team-size" min="5" max="30" value="13">
                        <div class="slider-group__range"><span>5</span><span>30</span></div>
                    </div>
                </div>

                <!-- Labor Cost Input (Editable) -->
                <div class="labor-cost-group" style="margin-top: var(--space-4); padding: var(--space-4); background: var(--color-ev-teal-soft); border: 1px solid var(--color-ev-teal); border-radius: var(--radius-md);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-2);">
                        <span style="font-weight: 600; font-size: var(--font-size-sm); color: var(--color-text-primary);">Labor Cost</span>
                        <span style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Key assumption</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: var(--space-3);">
                        <div style="display: flex; align-items: center; gap: var(--space-1);">
                            <span style="color: var(--color-text-secondary);">$</span>
                            <input type="number" id="input-labor-rate" value="75" min="25" max="200" step="5"
                                   style="width: 70px; padding: var(--space-2); border: 1px solid var(--color-border); border-radius: var(--radius-sm); font-size: var(--font-size-base); font-weight: 600; text-align: center; background: var(--color-bg-card); color: var(--color-ev-teal);">
                            <span style="color: var(--color-text-secondary); font-size: var(--font-size-sm);">/hr</span>
                        </div>
                        <span style="color: var(--color-text-muted);">=</span>
                        <div style="background: var(--color-bg-card); padding: var(--space-2) var(--space-3); border-radius: var(--radius-sm); border: 1px solid var(--color-border);">
                            <span style="font-weight: 700; color: var(--color-ev-teal); font-size: var(--font-size-base);">$<span id="val-labor-yearly">156K</span></span>
                            <span style="color: var(--color-text-muted); font-size: var(--font-size-xs);">/year</span>
                        </div>
                    </div>
                    <div style="font-size: var(--font-size-xs); color: var(--color-text-muted); margin-top: var(--space-2);">
                        Based on 2,080 work hours/year (40 hrs √ó 52 weeks)
                    </div>
                </div>

                <div class="info-tip">
                    üí° Results update automatically as you adjust sliders
                </div>

                <!-- Before/After Comparison -->
                <div style="margin-top: var(--space-5);">
                    <div style="font-weight: 600; font-size: var(--font-size-sm); margin-bottom: var(--space-3); color: var(--color-text-secondary);">Before ‚Üí After</div>
                    <div class="comparison-row">
                        <span class="comparison-row__label">Opportunities/Qtr</span>
                        <div class="comparison-row__values">
                            <span class="comparison-row__before" id="comp-before">18</span>
                            <span class="comparison-row__arrow">‚Üí</span>
                            <span class="comparison-row__after" id="comp-after">28</span>
                        </div>
                    </div>
                    <div class="comparison-row">
                        <span class="comparison-row__label">RFP Response</span>
                        <div class="comparison-row__values">
                            <span class="comparison-row__before">5 days</span>
                            <span class="comparison-row__arrow">‚Üí</span>
                            <span class="comparison-row__after">2 days</span>
                        </div>
                    </div>
                    <div class="comparison-row">
                        <span class="comparison-row__label">Team Efficiency</span>
                        <div class="comparison-row__values">
                            <span class="comparison-row__before">Baseline</span>
                            <span class="comparison-row__arrow">‚Üí</span>
                            <span class="comparison-row__after">+<span id="comp-efficiency">19</span>%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RIGHT: Results Panel (Sticky) -->
            <div class="results-panel">
                <div class="results-panel__header">Financial Projections</div>

                <!-- Hero ROI Display -->
                <div class="roi-hero">
                    <div class="roi-hero__label">Year 1 ROI</div>
                    <div class="roi-hero__value"><span id="result-roi">697</span>%</div>
                    <div class="roi-hero__subtext">Return on investment</div>
                    <div class="payback-badge">
                        ‚ö° Payback: <span id="result-payback">5</span> days
                    </div>
                </div>

                <!-- Metric Cards Grid -->
                <div class="metrics-grid">
                    <div class="metric-card metric-card--highlight">
                        <div class="metric-card__label">Revenue Uplift</div>
                        <div class="metric-card__value">$<span id="result-revenue">240K</span></div>
                    </div>
                    <div class="metric-card metric-card--highlight">
                        <div class="metric-card__label">Cost Savings</div>
                        <div class="metric-card__value">$<span id="result-savings">62K</span></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card__label">Pipeline Value</div>
                        <div class="metric-card__value">$<span id="result-pipeline">2M</span></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card__label">Hours Saved</div>
                        <div class="metric-card__value"><span id="result-hours">832</span></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card__label">Investment</div>
                        <div class="metric-card__value">$<span id="result-investment">11.5K</span></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card__label">New Opps/Year</div>
                        <div class="metric-card__value">+<span id="result-opps">40</span></div>
                    </div>
                </div>

                <button class="btn btn--secondary" onclick="resetCalculator()" style="width: 100%; margin-top: var(--space-3);">Reset to Defaults</button>
            </div>
        </div>

        <!-- Collapsible Sections Container -->
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 var(--space-6) var(--space-8);">

            <!-- Collapsible: How It's Calculated -->
            <div class="collapsible" onclick="toggleCollapsible(this)">
                <div class="collapsible__header">
                    <span>üìä How We Calculate These Numbers</span>
                    <span class="collapsible__icon">‚ñº</span>
                </div>
                <div class="collapsible__content">
                    <p style="margin-bottom: var(--space-3); color: var(--color-text-secondary); font-size: var(--font-size-sm);">
                        <strong>Pipeline Value:</strong> (Target - Current Opps) √ó 4 quarters √ó Deal Size
                    </p>
                    <div class="formula">(28 - 18) √ó 4 √ó $50K = $2M pipeline</div>

                    <p style="margin: var(--space-4) 0 var(--space-3); color: var(--color-text-secondary); font-size: var(--font-size-sm);">
                        <strong>Revenue Uplift:</strong> Annual Opportunity Increase √ó Win Rate √ó Deal Size
                    </p>
                    <div class="formula">40 opps √ó 12% √ó $50K = $240K revenue</div>

                    <p style="margin: var(--space-4) 0 var(--space-3); color: var(--color-text-secondary); font-size: var(--font-size-sm);">
                        <strong>Cost Savings:</strong> RFP Hours Saved √ó RFPs/Year √ó Labor Rate
                    </p>
                    <div class="formula">16 hrs √ó 52 RFPs √ó $<span id="formula-labor-rate">75</span>/hr = $<span id="formula-savings">62.4K</span> savings</div>

                    <p style="margin: var(--space-4) 0 var(--space-3); color: var(--color-text-secondary); font-size: var(--font-size-sm);">
                        <strong>ROI:</strong> (Revenue + Savings) √∑ Investment √ó 100
                    </p>
                    <div class="formula">($240K + $62K) √∑ $11.5K √ó 100 = 2,626% ROI</div>
                </div>
            </div>

            <!-- Collapsible: Assumptions -->
            <div class="collapsible" onclick="toggleCollapsible(this)">
                <div class="collapsible__header">
                    <span>‚öôÔ∏è Key Assumptions</span>
                    <span class="collapsible__icon">‚ñº</span>
                </div>
                <div class="collapsible__content">
                    <div class="assumptions-grid">
                        <div class="assumption-pill" style="border-color: var(--color-ev-teal); background: var(--color-ev-teal-soft);">
                            <div class="assumption-pill__label">Labor Cost <span style="font-weight: 400;">(editable above)</span></div>
                            <div class="assumption-pill__value">$<span id="assumption-labor-rate">75</span>/hr ‚Üí $<span id="assumption-labor-yearly">156K</span>/yr</div>
                        </div>
                        <div class="assumption-pill">
                            <div class="assumption-pill__label">RFP Frequency</div>
                            <div class="assumption-pill__value">~4/BDR/quarter</div>
                        </div>
                        <div class="assumption-pill">
                            <div class="assumption-pill__label">Base Investment</div>
                            <div class="assumption-pill__value">$8-15K total</div>
                        </div>
                        <div class="assumption-pill">
                            <div class="assumption-pill__label">Sales Cycle</div>
                            <div class="assumption-pill__value">Within 12 months</div>
                        </div>
                        <div class="assumption-pill">
                            <div class="assumption-pill__label">Adoption Rate</div>
                            <div class="assumption-pill__value">60-85% of team</div>
                        </div>
                        <div class="assumption-pill">
                            <div class="assumption-pill__label">Time Reduction</div>
                            <div class="assumption-pill__value">38% faster RFPs</div>
                        </div>
                    </div>
                    <p style="margin-top: var(--space-4); font-size: var(--font-size-xs); color: var(--color-text-muted);">
                        <strong>Disclaimer:</strong> This calculator is a projection tool. Actual results will vary based on implementation, team adoption, and market conditions.
                    </p>
                </div>
            </div>

            <!-- Compact CTA -->
            <div class="cta-compact">
                <h3>Ready to See Real Results?</h3>
                <p>Track live program performance and explore implementation guides.</p>
                <div class="btn-group">
                    <a href="progress.html" class="btn btn--primary">View Progress</a>
                    <a href="guides/index.html" class="btn btn--secondary">Guides</a>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <p>EasyVista AI Sales Enablement | Powered by <a href="https://yelin.io">Yelin.io</a></p>
        <p style="margin-top: var(--space-2);">Last updated: Feb 8, 2026</p>
    </footer>

    <script>
        // =====================================
        // Theme Handling
        // =====================================
        function getPreferredTheme() {
            const saved = localStorage.getItem('theme');
            if (saved) return saved;
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            document.getElementById('theme-icon').textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme') || 'light';
            setTheme(current === 'dark' ? 'light' : 'dark');
        }

        setTheme(getPreferredTheme());

        // =====================================
        // Mobile Navigation Toggle
        // =====================================
        function toggleNav() {
            document.getElementById('nav-links').classList.toggle('active');
        }

        // =====================================
        // Collapsible Sections
        // =====================================
        function toggleCollapsible(element) {
            element.classList.toggle('open');
        }

        // =====================================
        // Default Values
        // =====================================
        const defaults = {
            currentOpps: 18,
            targetOpps: 28,
            dealSize: 50000,
            winRate: 12,
            rfpHours: 16,
            teamSize: 13,
            laborRate: 75
        };

        // =====================================
        // Slider Event Listeners (Auto-calculate)
        // =====================================
        document.getElementById('slider-current-opps').addEventListener('input', function() {
            document.getElementById('val-current-opps').textContent = this.value;
            calculateROI();
        });

        document.getElementById('slider-target-opps').addEventListener('input', function() {
            document.getElementById('val-target-opps').textContent = this.value;
            calculateROI();
        });

        document.getElementById('slider-deal-size').addEventListener('input', function() {
            document.getElementById('val-deal-size').textContent = formatK(parseInt(this.value));
            calculateROI();
        });

        document.getElementById('slider-win-rate').addEventListener('input', function() {
            document.getElementById('val-win-rate').textContent = this.value;
            calculateROI();
        });

        document.getElementById('slider-rfp-hours').addEventListener('input', function() {
            document.getElementById('val-rfp-hours').textContent = this.value;
            calculateROI();
        });

        document.getElementById('slider-team-size').addEventListener('input', function() {
            document.getElementById('val-team-size').textContent = this.value;
            calculateROI();
        });

        document.getElementById('input-labor-rate').addEventListener('input', function() {
            updateLaborYearly();
            calculateROI();
        });

        // =====================================
        // Format Helpers
        // =====================================
        function formatK(value) {
            if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
            if (value >= 1000) return Math.round(value / 1000) + 'K';
            return value.toString();
        }

        function formatCurrency(value) {
            if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
            if (value >= 1000) return Math.round(value / 1000) + 'K';
            return Math.round(value).toLocaleString();
        }

        // =====================================
        // Labor Rate ‚Üí Yearly Calculation
        // =====================================
        function updateLaborYearly() {
            const hourlyRate = parseInt(document.getElementById('input-labor-rate').value) || defaults.laborRate;
            const yearlyRate = hourlyRate * 2080; // 40 hrs √ó 52 weeks
            document.getElementById('val-labor-yearly').textContent = formatCurrency(yearlyRate);
            // Also update the assumptions section
            document.getElementById('assumption-labor-rate').textContent = hourlyRate;
            document.getElementById('assumption-labor-yearly').textContent = formatCurrency(yearlyRate);
            // Update formula display
            document.getElementById('formula-labor-rate').textContent = hourlyRate;
        }

        // =====================================
        // Main ROI Calculator
        // =====================================
        function calculateROI() {
            const currentOpps = parseInt(document.getElementById('slider-current-opps').value);
            const targetOpps = parseInt(document.getElementById('slider-target-opps').value);
            const dealSize = parseInt(document.getElementById('slider-deal-size').value);
            const winRate = parseInt(document.getElementById('slider-win-rate').value);
            const rfpHours = parseInt(document.getElementById('slider-rfp-hours').value);
            const teamSize = parseInt(document.getElementById('slider-team-size').value);

            // Calculations
            const opportunityIncrease = (targetOpps - currentOpps) * 4;
            const pipelineValue = opportunityIncrease * dealSize;
            const revenueUplift = opportunityIncrease * (winRate / 100) * dealSize;

            const laborRate = parseInt(document.getElementById('input-labor-rate').value) || defaults.laborRate;
            const rfpsPerYear = Math.round((teamSize * 4 * 4) / 12);
            const totalHoursSaved = rfpsPerYear * rfpHours;
            const costSavings = totalHoursSaved * laborRate;

            const investment = 11009;
            const totalReturns = revenueUplift + costSavings;
            const roiPercent = investment > 0 ? ((totalReturns / investment) * 100) : 0;

            const dailyRevenue = revenueUplift > 0 ? revenueUplift / 365 : 0;
            const paybackDays = dailyRevenue > 0 ? Math.round(investment / dailyRevenue) : 365;

            const efficiencyGain = teamSize > 0 ? ((totalHoursSaved / (teamSize * 1920)) * 100) : 0;

            // Update DOM
            document.getElementById('result-roi').textContent = Math.round(roiPercent).toLocaleString();
            document.getElementById('result-payback').textContent = Math.max(1, Math.min(paybackDays, 365));
            document.getElementById('result-revenue').textContent = formatCurrency(revenueUplift);
            document.getElementById('result-savings').textContent = formatCurrency(costSavings);
            document.getElementById('result-pipeline').textContent = formatCurrency(pipelineValue);
            document.getElementById('result-hours').textContent = totalHoursSaved.toLocaleString();
            document.getElementById('result-investment').textContent = formatCurrency(investment);
            document.getElementById('result-opps').textContent = opportunityIncrease;

            // Comparison section
            document.getElementById('comp-before').textContent = currentOpps;
            document.getElementById('comp-after').textContent = targetOpps;
            document.getElementById('comp-efficiency').textContent = Math.round(efficiencyGain);
        }

        // =====================================
        // Reset Calculator
        // =====================================
        function resetCalculator() {
            document.getElementById('slider-current-opps').value = defaults.currentOpps;
            document.getElementById('slider-target-opps').value = defaults.targetOpps;
            document.getElementById('slider-deal-size').value = defaults.dealSize;
            document.getElementById('slider-win-rate').value = defaults.winRate;
            document.getElementById('slider-rfp-hours').value = defaults.rfpHours;
            document.getElementById('slider-team-size').value = defaults.teamSize;
            document.getElementById('input-labor-rate').value = defaults.laborRate;

            document.getElementById('val-current-opps').textContent = defaults.currentOpps;
            document.getElementById('val-target-opps').textContent = defaults.targetOpps;
            document.getElementById('val-deal-size').textContent = formatK(defaults.dealSize);
            document.getElementById('val-win-rate').textContent = defaults.winRate;
            document.getElementById('val-rfp-hours').textContent = defaults.rfpHours;
            document.getElementById('val-team-size').textContent = defaults.teamSize;

            updateLaborYearly();
            calculateROI();
        }

        // Initialize
        window.addEventListener('load', () => {
            document.getElementById('val-deal-size').textContent = formatK(defaults.dealSize);
            updateLaborYearly();
            setTimeout(calculateROI, 100);
        });
    </script>
</body>
</html>
